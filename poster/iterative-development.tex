\begin{center}

% Title formatter (this is what \stagetitle was *supposed* to be)
\providecommand{\PipelineStageTitle}[1]{%
  {\bfseries\Large\color{PMS310C}#1}%
}

\begin{tikzpicture}[
  font=\normalsize,
  stage/.style={
    draw=black, rounded corners=2.5mm, thick, fill=black!2,
    inner sep=7pt, text width=0.86\linewidth
  },
  pill/.style={
    draw=black!50, rounded corners=1.2mm, fill=white,
    font=\ttfamily\scriptsize, inner xsep=4pt, inner ysep=2pt
  },
  iconbox/.style={
    draw=black!55, rounded corners=1mm, thick, fill=white,
    minimum width=1.25cm, minimum height=1.25cm
  },
  arrow/.style={-Latex, thick},
  feedback/.style={-Latex, thick, dashed, draw=black!70},
  node distance=7mm
]
% Reserve horizontal padding inside each stage for the icon.
\def\IconPad{1.95cm}

% ----------------------------
% Simple inline “icons” (pure TikZ)
% ----------------------------
\providecommand{\PipelineCodeIcon}{%
  \tikz[scale=0.34, line width=0.9pt]{
    \draw[rounded corners=0.7pt] (0,0) rectangle (1.2,1.2);
    \draw (0.18,0.95)--(1.02,0.95);
    \draw (0.18,0.72)--(0.82,0.72);
    \draw (0.18,0.50)--(1.02,0.50);
    \draw (0.18,0.27)--(0.70,0.27);
    \draw (0.18,0.12)--(0.55,0.12);
  }%
}
\providecommand{\PipelineGearIcon}{%
  \tikz[scale=0.34, line width=0.9pt]{
    \draw (0.6,0.6) circle (0.34);
    \foreach \a in {0,30,...,330}{
      \draw[shift={(0.6,0.6)}, rotate=\a] (0.34,0) -- (0.50,0);
    }
    \draw (0.6,0.6) circle (0.12);
  }%
}
\providecommand{\PipelineStopwatchIcon}{%
  \tikz[scale=0.34, line width=0.9pt]{
    \draw (0.6,0.55) circle (0.38);
    \draw (0.45,0.98) rectangle (0.75,1.12);
    \draw (0.56,0.55) -- (0.56,0.80);
    \draw (0.56,0.55) -- (0.80,0.55);
    \draw (0.78,0.92) -- (0.98,1.05);
  }%
}
\providecommand{\PipelineBarsIcon}{%
  \tikz[scale=0.34, line width=0.9pt]{
    \draw (0.15,0.15) -- (0.15,1.10);
    \draw (0.15,0.15) -- (1.10,0.15);
    \filldraw (0.30,0.15) rectangle (0.48,0.55);
    \filldraw (0.55,0.15) rectangle (0.73,0.85);
    \filldraw (0.80,0.15) rectangle (0.98,0.42);
  }%
}
\providecommand{\PipelineChecklistIcon}{%
  \tikz[scale=0.34, line width=0.9pt]{
    \draw[rounded corners=0.7pt] (0,0) rectangle (1.2,1.2);
    \draw (0.18,0.86) -- (0.28,0.76) -- (0.45,0.94);
    \draw (0.55,0.86) -- (1.05,0.86);
    \draw (0.18,0.58) -- (0.28,0.48) -- (0.45,0.66);
    \draw (0.55,0.58) -- (1.05,0.58);
    \draw (0.18,0.30) -- (0.28,0.20) -- (0.45,0.38);
    \draw (0.55,0.30) -- (1.05,0.30);
  }%
}

% ----------------------------
% Stages (vertical pipeline)
% ----------------------------
\node[stage] (s1) {%
  \hspace*{\IconPad}\PipelineStageTitle{Stage 1: Mathematical Model \& Code}\par
  \hspace*{\IconPad}\normalsize Define the R\"ossler RHS in Julia.\par
  \hspace*{\IconPad}\scriptsize
    \tikz[baseline=-0.6ex]{\node[pill]{na\"ive};}\,
    \tikz[baseline=-0.6ex]{\node[pill]{in-place};}\,
    \tikz[baseline=-0.6ex]{\node[pill]{StaticArrays/SVector};}%
};

\node[stage, below=of s1] (s2) {%
  \hspace*{\IconPad}\PipelineStageTitle{Stage 2: Compilation \& Execution}\par
  \hspace*{\IconPad}\normalsize Julia JIT compiles hot paths to native code.\par
  \hspace*{\IconPad}\scriptsize (Warm-up compile excluded from measurements.)%
};

\node[stage, below=of s2] (s3) {%
  \hspace*{\IconPad}\PipelineStageTitle{Stage 3: Benchmarking \& Profiling}\par
  \hspace*{\IconPad}\normalsize Measure runtime \& allocations per implementation.\par
  \hspace*{\IconPad}\scriptsize \texttt{@benchmark/@btime} + \texttt{@allocated} + type checks%
};

\node[stage, below=of s3] (s4) {%
  \hspace*{\IconPad}\PipelineStageTitle{Stage 4: Visualization of Results}\par
  \hspace*{\IconPad}\normalsize Summarize performance and solution behavior.\par
  \hspace*{\IconPad}\scriptsize
    \tikz[baseline=-0.6ex]{\node[pill]{time};}\,
    \tikz[baseline=-0.6ex]{\node[pill]{allocs};}\,
    \tikz[baseline=-0.6ex]{\node[pill]{trajectory/GIF};}%
};

\node[stage, below=of s4] (s5) {%
  \hspace*{\IconPad}\PipelineStageTitle{Stage 5: Insights \& Optimization Cycle}\par
  \hspace*{\IconPad}\normalsize Convert findings into actionable improvements.\par
  \hspace*{\IconPad}\scriptsize e.g., eliminate allocations; choose data layout; select solver%
};

% Icons
\node[iconbox, anchor=west] at ([xshift=6pt]s1.west) {\PipelineCodeIcon};
\node[iconbox, anchor=west] at ([xshift=6pt]s2.west) {\PipelineGearIcon};
\node[iconbox, anchor=west] at ([xshift=6pt]s3.west) {\PipelineStopwatchIcon};
\node[iconbox, anchor=west] at ([xshift=6pt]s4.west) {\PipelineBarsIcon};
\node[iconbox, anchor=west] at ([xshift=6pt]s5.west) {\PipelineChecklistIcon};

% Forward arrows
\draw[arrow] (s1) -- (s2);
\draw[arrow] (s2) -- (s3);
\draw[arrow] (s3) -- (s4);
\draw[arrow] (s4) -- (s5);

% Feedback loop
\draw[feedback] (s5.east) -- ++(10mm,0) |- (s1.east);

\end{tikzpicture}

{\captionsetup{hypcap=false}%
\captionof{figure}{Pipeline overview: model/code $\rightarrow$ JIT compile $\rightarrow$ benchmark/profile $\rightarrow$ visualize $\rightarrow$ iterate.}}

\end{center}